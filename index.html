<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();
    let roomCode;

    function createRoom() {
        roomCode = Math.random().toString(36).substring(2, 7).toUpperCase();
        socket.emit('createRoom', roomCode);
        alert(`Room created! Share this code: ${roomCode}`);
        document.getElementById('roomCodeDisplay').textContent = `Room Code: ${roomCode}`;
        document.getElementById('teamSetup').style.display = 'block';
        document.getElementById('roomSetup').style.display = 'none';
    }

    function joinRoom() {
        roomCode = prompt("Enter room code:");
        socket.emit('joinRoom', roomCode);
        document.getElementById('roomCodeDisplay').textContent = `Room Code: ${roomCode}`;
        document.getElementById('teamSetup').style.display = 'block';
        document.getElementById('roomSetup').style.display = 'none';
    }

    socket.on('playerJoined', (numPlayers) => {
        alert(`Player ${numPlayers} has joined the room.`);
        if (numPlayers === 3) {
            document.getElementById('startButton').style.display = 'block';
        }
    });

    socket.on('gameStarted', (roomData) => {
        document.getElementById('gameDisplay').style.display = 'block';
        document.getElementById('teamSetup').style.display = 'none';
        startGame();
    });

    function startGame() {
        const words = document.getElementById('fileUpload').files[0];
        const reader = new FileReader();
        reader.onload = function(e) {
            const text = e.target.result.split(/\r?\n/).filter(word => word.trim().length > 0);
            socket.emit('startGame', roomCode, text);
        };
        reader.readAsText(words);
    }

    socket.on('scoreUpdate', (scores) => {
        updateScoreboard(scores);
    });

    socket.on('nextWord', (word) => {
        document.getElementById('word').textContent = word;
    });

    socket.on('roundStarted', (roomData) => {
        document.getElementById('nextRoundButton').style.display = 'none';
        startTimer();
        nextWord();
    });
</script>
